def generate_mindmap():
    data = request.json
    full_text = data.get("fullText", "")

    if not full_text:
        return jsonify({"message": "No text provided for mind map generation"}), 400

    mindmap_prompt = f"""Create a hierarchical mindmap from the following document. The output must be a single JSON object with a 'title' and a 'nodes' array. Each node in the array must have an 'id', a 'label', and a 'children' array. Do not include any notes or explanations outside of the JSON object.

Document:
{full_text[:4000]}"""

    mindmap_json = get_gemini_response(mindmap_prompt)

    if mindmap_json:
        print(f"Mindmap JSON from Gemini: {mindmap_json}")
        return jsonify(mindmap_json)
    else:
        return jsonify({"message": "Error generating mind map with Gemini"}), 500